apiVersion: v1
items:
  - apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations:
        autopilot.gke.io/resource-adjustment: '{"input":{"containers":[{"name":"router"}]},"output":{"containers":[{"limits":{"ephemeral-storage":"1Gi"},"requests":{"cpu":"500m","ephemeral-storage":"1Gi","memory":"2Gi"},"name":"router"}]},"modified":true}'
        autopilot.gke.io/warden-version: 31.23.0-gke.9
        deployment.kubernetes.io/revision: "14"
        kapp.k14s.io/change-group: cosmo.apps.router.wundergraph.com/deployment
        meta.helm.sh/release-name: router
        meta.helm.sh/release-namespace: default
      creationTimestamp: "2025-04-10T14:04:29Z"
      generation: 14
      labels:
        app.kubernetes.io/instance: router
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: router
      name: router
      namespace: default
      resourceVersion: "1397355"
      uid: 4466dd4c-af28-45a7-9634-8fc9cac15158
    spec:
      progressDeadlineSeconds: 600
      replicas: 1
      revisionHistoryLimit: 10
      strategy:
        rollingUpdate:
          maxSurge: 25%
          maxUnavailable: 25%
        type: RollingUpdate
      template:
        metadata:
          annotations:
            checksum/config: 45e0e52439d2f9b0caeb6a97399a3f4602a9b2d667ed71d6abf453a33790ac6c
            checksum/secret: f52d711103d50a437830c6fbcd04fb4bab49a0f82f6d26d1c791c6e8488dd090
          creationTimestamp: null
          labels:
            app.kubernetes.io/instance: router
            app.kubernetes.io/name: router
        spec:
          containers:
            - env:
                - name: LISTEN_ADDR
                  valueFrom:
                    configMapKeyRef:
                      key: listenAddress
                      name: router
                - name: LOG_LEVEL
                  valueFrom:
                    configMapKeyRef:
                      key: logLevel
                      name: router
              image: ghcr.io/wundergraph/cosmo/router:latest
              imagePullPolicy: IfNotPresent
              livenessProbe:
                failureThreshold: 3
                httpGet:
                  path: /health/live
                  port: http
                  scheme: HTTP
                initialDelaySeconds: 10
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 1
              name: router
              ports:
                - containerPort: 8088
                  protocol: TCP
                - containerPort: 80
                  name: http
                  protocol: TCP
              readinessProbe:
                failureThreshold: 3
                httpGet:
                  path: /health/ready
                  port: http
                  scheme: HTTP
                initialDelaySeconds: 5
                periodSeconds: 10
                successThreshold: 1
                timeoutSeconds: 1
              resources:
                limits:
                  ephemeral-storage: 1Gi
                requests:
                  cpu: 500m
                  ephemeral-storage: 1Gi
                  memory: 2Gi
              securityContext:
                capabilities:
                  drop:
                    - NET_RAW
              terminationMessagePath: /dev/termination-log
              terminationMessagePolicy: File
              volumeMounts:
                - mountPath: /config.yaml
                  name: router-config
                  subPath: config.yaml
          dnsPolicy: ClusterFirst
          restartPolicy: Always
          schedulerName: default-scheduler
          securityContext:
            seccompProfile:
              type: RuntimeDefault
          serviceAccount: router
          serviceAccountName: router
          terminationGracePeriodSeconds: 30
          tolerations:
            - effect: NoSchedule
              key: kubernetes.io/arch
              operator: Equal
              value: amd64
          volumes:
            - configMap:
                defaultMode: 420
                name: router-config
              name: router-config
    status:
      availableReplicas: 1
      conditions:
        - lastTransitionTime: "2025-04-11T11:17:43Z"
          lastUpdateTime: "2025-04-11T11:17:43Z"
          message: Deployment has minimum availability.
          reason: MinimumReplicasAvailable
          status: "True"
          type: Available
        - lastTransitionTime: "2025-04-11T13:15:48Z"
          lastUpdateTime: "2025-04-11T13:15:48Z"
          message: ReplicaSet "router-5d4586ff7" is progressing.
          reason: ReplicaSetUpdated
          status: "True"
          type: Progressing
      observedGeneration: 14
      readyReplicas: 1
      replicas: 2
      unavailableReplicas: 1
      updatedReplicas: 1
kind: List
metadata:
  resourceVersion: ""
